<section class="row">
  <div class="col-sm-12 admin-inner-tab main-content form-horizontal" ng-form="vm.activityForm">
    <div class="row" ng-if="vm.workType === 'cp-upload' || (vm.workType === '' && vm.productId)">
      <div class="col-sm-12">
        <h3>Certified Product - Uploads</h3>
        <div>
          <label for="activity-start-upload" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.startDate" name="activityStartUpload" id="activity-start-upload" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-upload" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.endDate" name="activityEndUpload" id="activity-end-upload" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('listing')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('listing')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedCertifiedProductsUpload" st-safe-src="vm.searchedCertifiedProductsUpload" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
              <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
              <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
              <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
              <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
              <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
              <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
              <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
              <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
              <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="7">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedCertifiedProductsUpload" filename="CP_Upload_{{ vm.filename }}"
                   csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity Date']"
                   csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedCertifiedProductsUpload.length === 0">
              <td colspan="7">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedCertifiedProductsUpload" ng-if="vm.displayedCertifiedProductsUpload.length > 0">
              <td>{{ activity.acb }}</td>
              <td>{{ activity.developer }}</td>
              <td>{{ activity.product }}</td>
              <td>{{ activity.certificationEdition }}</td>
              <td>
                <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
                <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
              </td>
              <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'cp-status' || (vm.workType === '' && vm.productId)">
      <div class="col-sm-12">
        <h3>Certification Status Changes</h3>
        <div>
          <label for="activity-start-status" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.startDate" name="activityStartStatus" id="activity-start-status" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-status" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.endDate" name="activityEndStatus" id="activity-end-status" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('listing')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('listing')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedCertifiedProductsStatus" st-safe-src="vm.searchedCertifiedProductsStatus" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
              <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
              <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
              <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
              <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
              <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
              <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
              <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
              <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
              <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="7">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedCertifiedProductsStatus" filename="CP_Status_{{ vm.filename }}"
                   csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity', 'Activity Date']"
                   csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'details', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedCertifiedProductsStatus.length === 0">
              <td colspan="8">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedCertifiedProductsStatus" ng-if="vm.displayedCertifiedProductsStatus.length > 0">
              <td>{{ activity.acb }}</td>
              <td>{{ activity.developer }}</td>
              <td>{{ activity.product }}</td>
              <td>{{ activity.certificationEdition }}</td>
              <td>
                <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
                <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
              </td>
              <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
              <td ng-bind-html="activity.details"></td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'cp-surveillance' || (vm.workType === '' && vm.productId)">
      <div class="col-sm-12">
        <h3>Surveillance Activity</h3>
        <div>
          <label for="activity-start-surveillance" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.startDate" name="activityStartSurveillance" id="activity-start-surveillance" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-surveillance" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.endDate" name="activityEndSurveillance" id="activity-end-surveillance" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('listing')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('listing')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedCertifiedProductsSurveillance" st-safe-src="vm.searchedCertifiedProductsSurveillance" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
              <th>Action</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="4">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedCertifiedProductsSurveillance" filename="CP_Surveillance_{{ vm.filename }}"
                   csv-header="['ACB', 'Action', 'Activity', 'Activity Date']"
                   csv-column-order="['acb', 'action', 'csvDetails', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedCertifiedProductsSurveillance.length === 0">
              <td colspan="8">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedCertifiedProductsSurveillance" ng-if="vm.displayedCertifiedProductsSurveillance.length > 0">
              <td>{{ activity.acb }}</td>
              <td ng-bind-html="activity.action"></td>
              <td>
                <ul class="list-unstyled" ng-if="activity.details && activity.details.length > 0">
                  <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
                </ul>
                <button class="btn btn-sm btn-ai-success" ng-click="vm.compareSurveillances(activity.source.oldS,activity.source.newS)" ng-if="activity.source"><i class="fa fa-search"></i>View Details</button>
              </td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'cap' || (vm.workType === '' && vm.productId)">
      <div class="col-sm-12">
        <h3>Corrective Action Plans</h3>
        <div>
          <label for="activity-start-cap" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.cap.startDate" name="activityStartCap" id="activity-start-cap" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-cap" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.cap.endDate" name="activityEndCap" id="activity-end-cap" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('cap')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('cap')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedCertifiedProductsCAP" st-safe-src="vm.searchedCertifiedProductsCAP" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
              <th>Action</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="4">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedCertifiedProductsCAP" filename="CP_CAP_{{ vm.filename }}"
                   csv-header="['ACB', 'Action', 'Activity', 'Activity Date']"
                   csv-column-order="['acb', 'action', 'csvDetails', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedCertifiedProductsCAP.length === 0">
              <td colspan="8">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedCertifiedProductsCAP" ng-if="vm.displayedCertifiedProductsCAP.length > 0">
              <td>{{ activity.acb }}</td>
              <td ng-bind-html="activity.action"></td>
              <td>
                <ul class="list-unstyled" ng-if="activity.details">
                  <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
                </ul>
              </td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'cp-other' || (vm.workType === '' && vm.productId)">
      <div class="col-sm-12">
        <h3>Other Certified Product Activities</h3>
        <div>
          <label for="activity-start-other" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.startDate" name="activityStartOther" id="activity-start-other" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-other" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.listing.endDate" name="activityEndOther" id="activity-end-other" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('listing')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('listing')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedCertifiedProducts" st-safe-src="vm.searchedCertifiedProducts" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
              <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
              <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
              <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
              <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
              <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
              <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
              <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
              <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
              <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="7">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedCertifiedProducts" filename="CP_Other_{{ vm.filename }}"
                   csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity', 'Activity Date']"
                   csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'csvDetails', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedCertifiedProducts.length === 0">
              <td colspan="8">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedCertifiedProducts" ng-if="vm.displayedCertifiedProducts.length > 0">
              <td>{{ activity.acb }}</td>
              <td>{{ activity.developer }}</td>
              <td>{{ activity.product }}</td>
              <td>{{ activity.certificationEdition }}</td>
              <td>
                <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
                <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
              </td>
              <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
              <td>
                <ul class="list-unstyled" ng-if="activity.details">
                  <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
                </ul>
              </td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'dev'">
      <div class="col-sm-12">
        <h3>Developer Activity</h3>
        <div>
          <label for="activity-start-developer" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.developer.startDate" name="activityStartDeveloper" id="activity-start-developer" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-developer" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.developer.endDate" name="activityEndDeveloper" id="activity-end-developer" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('developer')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('developer')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedDevelopers" st-safe-src="vm.searchedDevelopers" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
              <th class="search-header" st-sort="developerCode" st-skip-natural="true">Developer Code</th>
              <th class="search-header" st-sort="responsibleUser" st-skip-natural="true">Responsible User</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
              <th><input st-search="developerCode" placeholder="Filter Developer Code" class="input-sm form-control" type="search"></th>
              <th><input st-search="responsibleUser" placeholder="Filter Responsible User" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="5">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedDevelopers" filename="Developers_{{ vm.filename }}"
                   csv-header="['Developer', 'Developer Code', 'Resonsible User', 'Activity', 'Details', 'Activity Date']"
                   csv-column-order="['developer', 'developerCode', 'responsibleUser', 'csvAction', 'csvDetails', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedDevelopers.length === 0">
              <td colspan="5">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedDevelopers" ng-if="vm.displayedDevelopers.length > 0">
              <td>{{ activity.developer }}</td>
              <td>{{ activity.developerCode }}</td>
              <td>{{ activity.responsibleUser }}</td>
              <td>
                <span ng-bind-html="activity.action"></span>
                <ul class="list-unstyled" ng-if="activity.details">
                  <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
                </ul>
              </td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'prod'">
      <div class="col-sm-12">
        <h3>Product Activity</h3>
        <div>
          <label for="activity-start-product" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.product.startDate" name="activityStartProduct" id="activity-start-product" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-product" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.product.endDate" name="activityEndProduct" id="activity-end-product" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('product')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('product')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedProducts" st-safe-src="vm.searchedProducts" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
              <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
              <th class="search-header" st-sort="responsibleUser" st-skip-natural="true">Responsible User</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
            </tr>
            <tr>
              <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
              <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
              <th><input st-search="responsibleUser" placeholder="Filter Responsible User" class="input-sm form-control" type="search"></th>
              <th>&nbsp;</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tfoot>
            <tr>
              <td colspan="5">
                <a type="button" class="btn btn-lg btn-ai-success"
                   ng-csv="vm.displayedProducts" filename="Products_{{ vm.filename }}"
                   csv-header="['Developer', 'Product', 'Resonsible User', 'Activity', 'Activity Date']"
                   csv-column-order="['developer', 'product', 'responsibleUser', 'action', 'friendlyActivityDate']">
                  <i class="fa fa-cloud-download"></i> Download
                </a>
              </td>
            </tr>
          </tfoot>
          <tbody>
            <tr ng-if="vm.displayedProducts.length === 0">
              <td colspan="5">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedProducts" ng-if="vm.displayedProducts.length > 0">
              <td>{{ activity.developer }}</td>
              <td>{{ activity.product }}</td>
              <td>{{ activity.responsibleUser }}</td>
              <td>
                <span ng-bind-html="activity.action"></span>
              </td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
        <h3>Version Activity</h3>
        <table st-table="vm.displayedVersions" st-safe-src="vm.searchedVersions" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
              <th class="search-header" st-sort="name" st-skip-natural="true">Version</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedVersions.length === 0">
              <td colspan="4">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedVersions" ng-if="vm.displayedVersions.length > 0">
              <td>{{ activity.product }}</td>
              <td>{{ activity.name }}</td>
              <td><span ng-bind-html="activity.action"></span></td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'acb'">
      <div class="col-sm-12">
        <h3>ONC-ACB Activity</h3>
        <div>
          <label for="activity-start-acb" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.acb.startDate" name="activityStartACB" id="activity-start-acb" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-acb" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.acb.endDate" name="activityEndACB" id="activity-end-acb" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('acb')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('acb')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedACBs" st-safe-src="vm.searchedACBs" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="name" st-skip-natural="true">ONC-ACB</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedACBs.length === 0">
              <td colspan="3">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedACBs" ng-if="vm.displayedACBs.length > 0">
              <td>{{ activity.name }}</td>
              <td><span ng-bind-html="activity.action"></span></td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'atl'">
      <div class="col-sm-12">
        <h3>ONC-ATL Activity</h3>
        <div>
          <label for="activity-start-atl" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.atl.startDate" name="activityStartATL" id="activity-start-atl" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-atl" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.atl.endDate" name="activityEndATL" id="activity-end-atl" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('atl')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('atl')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedATLs" st-safe-src="vm.searchedATLs" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="name" st-skip-natural="true">ONC-ATL</th>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedATLs.length === 0">
              <td colspan="3">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedATLs" ng-if="vm.displayedATLs.length > 0">
              <td>{{ activity.name }}</td>
              <td><span ng-bind-html="activity.action"></span></td>
              <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'announcement'">
      <div class="col-sm-12">
        <h3>Announcement Activity</h3>
        <div>
          <label for="activity-start-announcement" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.announcement.startDate" name="activityStartAnnouncement" id="activity-start-announcement" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-announcement" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.announcement.endDate" name="activityEndAnnouncement" id="activity-end-announcement" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('announcement')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('announcement')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedAnnouncements" st-safe-src="vm.searchedAnnouncements" class="table table-striped">
          <thead>
            <tr>
              <th class="search-header" st-sort="name" st-skip-natural="true">Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedAnnouncements.length === 0">
              <td colspan="2">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedAnnouncements" ng-if="vm.displayedAnnouncements.length > 0">
              <td>{{ activity.description }}</td>
              <td>{{ activity.activityDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'users'">
      <div class="col-sm-12">
        <h3>User Activity</h3>
        <div>
          <label for="activity-start-user-activity" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.userActivity.startDate" name="activityStartUserActivity" id="activity-start-user-activity" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-user-activity" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.userActivity.endDate" name="activityEndUserActivity" id="activity-end-user-activity" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('userActivity')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('userActivity')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedUsers" st-safe-src="vm.searchedUsers" class="table table-striped">
          <thead>
            <tr>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedUsers.length === 0">
              <td colspan="2">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedUsers" ng-if="vm.displayedUsers.length > 0">
              <td><span ng-bind-html="activity.description"></span></td>
              <td>{{ activity.activityDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
        <h3>User Actions</h3>
        <table st-table="vm.displayedUserActivities" st-safe-src="vm.searchedUserActivities" class="table">
          <thead>
            <tr>
              <th class="search-header" st-sort="user.fullName" st-skip-natural="true" st-sort-default>User</th>
              <th scope="col">Action</th>
              <th scope="col">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedUserActivities.length === 0">
              <td colspan="3">No activity found</td>
            </tr>
            <tr ng-repeat-start="activity in vm.displayedUserActivities" ng-if="vm.displayedUserActivities.length > 0">
              <td rowspan="{{ activity.events.length }}">{{ activity.user.fullName }}<br />{{ activity.user.email }}</td>
              <td>{{ activity.events[0].description }}</td>
              <td>{{ activity.events[0].activityDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
            <tr ng-repeat="action in activity.events" ng-if="!$first && vm.displayedUserActivities.length > 0" ng-repeat-end>
              <td>{{ action.description }}</td>
              <td>{{ action.activityDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'api_key_management'">
      <div class="col-sm-12">
        <h3>API Key Management Activity</h3>
        <div>
          <label for="activity-start-api-key" class="col-sm-2 control-label">Start Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.api_key.startDate" name="activityStartAPIKey" id="activity-start-api-key" placeholder="yyyy-MM-dd">
          </div>
          <label for="activity-end-api-key" class="col-sm-2 control-label">End Date</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" ng-model="vm.activityRange.api_key.endDate" name="activityEndAPIKey" id="activity-end-api-key" placeholder="yyyy-MM-dd">
          </div>
          <div class="col-sm-2">
            <button class="btn btn-primary" ng-click="vm.refreshActivity()" ng-disabled="!vm.validDates('api_key')">Search <i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-12 text-danger" ng-if="!vm.validDates('api_key')">Start date must be before end date, and no more than {{ vm.activityRange.range }} days apart</div>
        </div>
        <table st-table="vm.displayedApiActivity" st-safe-src="vm.searchedApiActivity" class="table table-striped">
          <thead>
            <tr>
              <th>Activity</th>
              <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Date</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-if="vm.displayedApiActivity.length === 0">
              <td colspan="2">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.displayedApiActivity" ng-if="vm.displayedApiActivity.length > 0">
              <td><span ng-bind-html="activity.description"></span></td>
              <td>{{ activity.activityDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row" ng-if="vm.workType === 'api_key_usage'">
      <div class="col-sm-12">
        <h3>API Key Usage</h3>
        <div class="form-horizontal">
          <div>
            <label for="api-key-start-date" class="col-sm-2 control-label">Start Date</label>
            <div class="col-sm-3">
              <input type="date" class="form-control" ng-model="vm.apiKey.startDate" name="apiKeyStartDate" id="api-key-start-date">
            </div>
            <label for="api-key-end-date" class="col-sm-2 control-label">End Date</label>
            <div class="col-sm-3">
              <input type="date" class="form-control" ng-model="vm.apiKey.endDate" name="apiKeyEndDate" id="api-key-end-date">
            </div>
            <div class="col-sm-2">
              <button class="btn btn-primary" ng-click="vm.refreshApiKeyUsage()">Search <i class="fa fa-search"></i></button>
            </div>
          </div>
          <div>
            <label for="api-key-date-ascending" class="col-sm-2 control-label">Oldest first</label>
            <div class="col-sm-2">
              <input type="checkbox" ng-model="vm.apiKey.dateAscending" name="apiKeyDateAscending" id="api-key-date-ascending" ng-change="vm.refreshApiKeyUsage()">
            </div>
            <label for="api-key-filter" class="col-sm-3 control-label">Show <a ng-click="vm.apiKey.showOnly = !vm.apiKey.showOnly; vm.refreshApiKeyUsage()">{{ vm.apiKey.showOnly ? 'only' : 'all but'}}</a> usage by API-Key</label>
            <div class="col-sm-5">
              <select class="form-control" ng-model="vm.apiKey.filter" name="apiKeyFilter" id="api-key-filter" ng-change="vm.refreshApiKeyUsage()"
                      ng-options="key.key as (key.name + ' (' + key.email + ')') for key in vm.apiKeys | orderBy:'name' track by key.key">
                <option value=""></option>
              </select>
            </div>
          </div>
          <div class="col-sm-12"><a href ng-click="vm.clearApiKeyFilter(); vm.refreshApiKeyUsage();">Clear all filters</a></div>
        </div>
        <table class="table table-striped">
          <thead>
            <tr>
              <th>API Key</th>
              <th scope="col">Email</th>
              <th scope="col">Name</th>
              <th scope="col">API Call Path</th>
              <th scope="col">Date</th>
            </tr>
          </thead>
          <tfoot>
            <td colspan="5" class="text-center">
              <pager ng-model="vm.apiKey.visiblePage" ng-change="vm.refreshApiKeyUsage()" class="pagination-sm" total-items="20000"></pager>
            </td>
          </tfoot>
          <tbody>
            <tr ng-if="vm.searchedApi.length === 0">
              <td colspan="5">No activity found</td>
            </tr>
            <tr ng-repeat="activity in vm.searchedApi" ng-if="vm.searchedApi.length > 0">
              <td>{{ activity.apiKey }}</td>
              <td>{{ activity.email }}</td>
              <td>{{ activity.name }}</td>
              <td>{{ activity.apiCallPath }}</td>
              <td>{{ activity.creationDate | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
