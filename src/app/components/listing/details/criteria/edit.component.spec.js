(() => {
  'use strict';

  describe('the Certification Criteria Modal controller', () => {
    var $compile, $log, ctrl, el, mock, scope;

    mock = {};
    mock.cert = {
      id: 1,
      number: '170.315 (c)(4)',
      criterion: {
        number: '170.315 (c)(4)',
        name: '170.315 (c)(4): Clinical Quality Measures - Filter',
        removed: false,
      },
      allowedSvaps: [
        {svapId: 1, regulatoryTextCitation: 'reg1', approvedStandardVersion: 'ver1'},
        {svapId: 2, regulatoryTextCitation: 'reg2', approvedStandardVersion: 'ver2'},
      ],
      svaps: [
        {svapId: 1, regulatoryTextCitation: 'reg1', approvedStandardVersion: 'ver1'},
      ],
    };
    mock.resources = {
      functionalitiesTested: [],
      testData: {'expandable': false,'data': [{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 50,'number': '170.315 (g)(1)','title': 'Automated Numerator Recording','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 49,'number': '170.315 (f)(7)','title': 'Transmission to Public Health Agencies - Health Care Surveys','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 52,'number': '170.315 (g)(3)','title': 'Safety-Enhanced Design','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 51,'number': '170.315 (g)(2)','title': 'Automated Measure Calculation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 46,'number': '170.315 (f)(4)','title': 'Transmission to Cancer Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 45,'number': '170.315 (f)(3)','title': 'Transmission to Public Health Agencies - Reportable Laboratory Tests and Values/Results','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 48,'number': '170.315 (f)(6)','title': 'Transmission to Public Health Agencies - Antimicrobial Use and Resistance Reporting','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 47,'number': '170.315 (f)(5)','title': 'Transmission to Public Health Agencies - Electronic Case Reporting','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 58,'number': '170.315 (g)(9)','title': 'Application Access - All Data Request','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 57,'number': '170.315 (g)(8)','title': 'Application Access - Data Category Request','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 60,'number': '170.315 (h)(2)','title': 'Direct Project, Edge Protocol, and XDR/XDM','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 59,'number': '170.315 (h)(1)','title': 'Direct Project','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 54,'number': '170.315 (g)(5)','title': 'Accessibility-Centered Design','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 53,'number': '170.315 (g)(4)','title': 'Quality Management System','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 56,'number': '170.315 (g)(7)','title': 'Application Access - Patient Selection','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 55,'number': '170.315 (g)(6)','title': 'Consolidated CDA Creation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 66,'number': '170.314 (a)(6)','title': 'Medication list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 65,'number': '170.314 (a)(5)','title': 'Problem list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 68,'number': '170.314 (a)(8)','title': 'Clinical decision support','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 67,'number': '170.314 (a)(7)','title': 'Medication allergy list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 62,'number': '170.314 (a)(2)','title': 'Drug-drug, drug-allergy interactions checks','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 61,'number': '170.314 (a)(1)','title': 'Computerized provider order entry','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 64,'number': '170.314 (a)(4)','title': 'Vital signs, body mass index, and growth Charts','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 63,'number': '170.314 (a)(3)','title': 'Demographics','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 74,'number': '170.314 (a)(14)','title': 'Patient list creation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 73,'number': '170.314 (a)(13)','title': 'Family health history','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 76,'number': '170.314 (a)(16)','title': 'Inpatient setting only - electronic medication administration record','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 75,'number': '170.314 (a)(15)','title': 'Patient-specific education resources','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 70,'number': '170.314 (a)(10)','title': 'Drug formulary checks','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 69,'number': '170.314 (a)(9)','title': 'Electronic notes','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 72,'number': '170.314 (a)(12)','title': 'Image results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 71,'number': '170.314 (a)(11)','title': 'Smoking status','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 82,'number': '170.314 (b)(2)','title': 'Transitions of care - create and transmit transition of care/referral summaries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 81,'number': '170.314 (b)(1)','title': 'Transitions of care - receive, display and incorporate transition of care/referral summaries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 84,'number': '170.314 (b)(4)','title': 'Clinical information reconciliation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 83,'number': '170.314 (b)(3)','title': 'Electronic prescribing','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 78,'number': '170.314 (a)(18)','title': 'Optional - computerized provider order entry - medications','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 28,'number': '170.315 (c)(4)','title': 'Clinical Quality Measures - Filter','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 77,'number': '170.314 (a)(17)','title': 'Advance directives','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 80,'number': '170.314 (a)(20)','title': 'Optional - computerized provider order entry - diagnostic imaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 79,'number': '170.314 (a)(19)','title': 'Optional - computerized provider order entry - laboratory','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 90,'number': '170.314 (b)(9)','title': 'Optional - clinical information reconciliation and incorporation (CIRI)','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 89,'number': '170.314 (b)(8)','title': 'Optional - transitions of care','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 92,'number': '170.314 (c)(2)','title': 'Clinical quality measures - import and calculate','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 91,'number': '170.314 (c)(1)','title': 'Clinical quality measures - capture and export','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 86,'number': '170.314 (b)(5)(B)','title': 'Incorporate laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 85,'number': '170.314 (b)(5)(A)','title': 'Incorporate laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 88,'number': '170.314 (b)(7)','title': 'Data portability','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 87,'number': '170.314 (b)(6)','title': 'Inpatient setting only - transmission of electronic laboratory tests and values/results to ambulatory providers','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 98,'number': '170.314 (d)(5)','title': 'Automatic log-off','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 97,'number': '170.314 (d)(4)','title': 'Amendments','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 100,'number': '170.314 (d)(7)','title': 'End-user device encryption','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 99,'number': '170.314 (d)(6)','title': 'Emergency access','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 94,'number': '170.314 (d)(1)','title': 'Authentication, access, control, and authorization','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 93,'number': '170.314 (c)(3)','title': 'Clinical quality measures - electronic submission','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 96,'number': '170.314 (d)(3)','title': 'Audit report(s)','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 95,'number': '170.314 (d)(2)','title': 'Auditable events and tamper-resistance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 106,'number': '170.314 (f)(1)','title': 'Immunization information','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 105,'number': '170.314 (e)(3)','title': 'Ambulatory setting only - secure messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 108,'number': '170.314 (f)(3)','title': 'Transmission to public health agencies - syndromic surveillance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 107,'number': '170.314 (f)(2)','title': 'Transmission to immunization registries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 102,'number': '170.314 (d)(9)','title': 'Optional - accounting of disclosures','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 101,'number': '170.314 (d)(8)','title': 'Integrity','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 104,'number': '170.314 (e)(2)','title': 'Ambulatory setting only -clinical summary','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 103,'number': '170.314 (e)(1)','title': 'View, download, and transmit to a 3rd party with edge protocol testing','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 114,'number': '170.314 (g)(2)','title': 'Automated measure calculation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 113,'number': '170.314 (g)(1)','title': 'Automated numerator recording','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 116,'number': '170.314 (g)(4)','title': 'Quality management system','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 115,'number': '170.314 (g)(3)','title': 'Safety-enhanced design','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 110,'number': '170.314 (f)(5)','title': 'Optional - ambulatory setting only - cancer case information','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 109,'number': '170.314 (f)(4)','title': 'Inpatient setting only - transmission of reportable laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 112,'number': '170.314 (f)(7)','title': 'Optional - ambulatory setting only - transmission to public health agencies - syndromic surveillance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 111,'number': '170.314 (f)(6)','title': 'Optional - ambulatory setting only - transmission to cancer registries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 3,'name': 'HIMSS-IIP Test Method','description': null,'title': null,'criteria': {'id': 43,'number': '170.315 (f)(1)','title': 'Transmission to Immunization Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 118,'number': '170.314 (h)(2)','title': 'Optional - Transmit - Applicability Statement for Secure Health Transport and XDR/XDM for Direct Messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 117,'number': '170.314 (h)(1)','title': 'Optional - Transmit - Applicability Statement for Secure Health','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 119,'number': '170.314 (h)(3)','title': 'Optional - Transmit - SOAP Transport and Security Specification and XDR/XDM for Direct Messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 2,'number': '170.315 (a)(2)','title': 'CPOE - Laboratory','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 1,'number': '170.315 (a)(1)','title': 'Computerized Provider Order Entry (CPOE) - Medications','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 4,'number': '170.315 (a)(4)','title': 'Drug-Drug, Drug-Allergy Interaction Checks for CPOE','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 3,'number': '170.315 (a)(3)','title': 'CPOE - Diagnostic Imaging','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 10,'number': '170.315 (a)(10)','title': 'Drug-Formulary and Preferred Drug List Checks','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 9,'number': '170.315 (a)(9)','title': 'Clinical Decision Support','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 12,'number': '170.315 (a)(12)','title': 'Family Health History','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 27,'number': '170.315 (c)(3)','title': 'Clinical Quality Measures - Report','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 11,'number': '170.315 (a)(11)','title': 'Smoking Status','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 26,'number': '170.315 (c)(2)','title': 'Clinical Quality Measures - Import and Calculate','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 6,'number': '170.315 (a)(6)','title': 'Problem List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 5,'number': '170.315 (a)(5)','title': 'Demographics','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 8,'number': '170.315 (a)(8)','title': 'Medication Allergy List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 7,'number': '170.315 (a)(7)','title': 'Medication List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 18,'number': '170.315 (b)(3)','title': 'Electronic Prescribing','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 17,'number': '170.315 (b)(2)','title': 'Clinical Information Reconciliation and Incorporation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 20,'number': '170.315 (b)(5)','title': 'Common Clinical Data Set Summary Record - Receive','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 19,'number': '170.315 (b)(4)','title': 'Common Clinical Data Set Summary Record - Create','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 14,'number': '170.315 (a)(14)','title': 'Implantable Device List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 13,'number': '170.315 (a)(13)','title': 'Patient-Specific Education Resources','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 16,'number': '170.315 (b)(1)','title': 'Transitions of Care','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 15,'number': '170.315 (a)(15)','title': 'Social, Psychological, and Behavioral Determinants Data','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 26,'number': '170.315 (c)(2)','title': 'Clinical Quality Measures - Import and Calculate','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 25,'number': '170.315 (c)(1)','title': 'Clinical Quality Measures - Record and Export','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 28,'number': '170.315 (c)(4)','title': 'Clinical Quality Measures - Filter','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 27,'number': '170.315 (c)(3)','title': 'Clinical Quality Measures - Report','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 22,'number': '170.315 (b)(7)','title': 'Data Segmentation for Privacy - Send','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 21,'number': '170.315 (b)(6)','title': 'Data Export','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 24,'number': '170.315 (b)(9)','title': 'Care Plan','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 23,'number': '170.315 (b)(8)','title': 'Data Segmentation for Privacy - Receive','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 34,'number': '170.315 (d)(6)','title': 'Emergency Access','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 33,'number': '170.315 (d)(5)','title': 'Automatic Access Time-out','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 36,'number': '170.315 (d)(8)','title': 'Integrity','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 35,'number': '170.315 (d)(7)','title': 'End-User Device Encryption','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 30,'number': '170.315 (d)(2)','title': 'Auditable Events and Tamper-Resistance','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 29,'number': '170.315 (d)(1)','title': 'Authentication, Access Control, Authorization','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 32,'number': '170.315 (d)(4)','title': 'Amendments','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 31,'number': '170.315 (d)(3)','title': 'Audit Report(s)','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 42,'number': '170.315 (e)(3)','title': 'Patient Health Information Capture','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 41,'number': '170.315 (e)(2)','title': 'Secure Messaging','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 44,'number': '170.315 (f)(2)','title': 'Transmission to Public Health Agencies - Syndromic Surveillance','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 43,'number': '170.315 (f)(1)','title': 'Transmission to Immunization Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 38,'number': '170.315 (d)(10)','title': 'Auditing Actions on Health Information','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 37,'number': '170.315 (d)(9)','title': 'Trusted Connection','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 40,'number': '170.315 (e)(1)','title': 'View, Download, and Transmit to 3rd Party','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 39,'number': '170.315 (d)(11)','title': 'Accounting of Disclosures','certificationEditionId': 3,'certificationEdition': '2015','description': null}}]},
      testProcedures: {'expandable': false,'data': [{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 50,'number': '170.315 (g)(1)','title': 'Automated Numerator Recording','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 49,'number': '170.315 (f)(7)','title': 'Transmission to Public Health Agencies - Health Care Surveys','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 52,'number': '170.315 (g)(3)','title': 'Safety-Enhanced Design','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 51,'number': '170.315 (g)(2)','title': 'Automated Measure Calculation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 46,'number': '170.315 (f)(4)','title': 'Transmission to Cancer Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 45,'number': '170.315 (f)(3)','title': 'Transmission to Public Health Agencies - Reportable Laboratory Tests and Values/Results','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 48,'number': '170.315 (f)(6)','title': 'Transmission to Public Health Agencies - Antimicrobial Use and Resistance Reporting','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 47,'number': '170.315 (f)(5)','title': 'Transmission to Public Health Agencies - Electronic Case Reporting','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 58,'number': '170.315 (g)(9)','title': 'Application Access - All Data Request','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 57,'number': '170.315 (g)(8)','title': 'Application Access - Data Category Request','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 60,'number': '170.315 (h)(2)','title': 'Direct Project, Edge Protocol, and XDR/XDM','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 59,'number': '170.315 (h)(1)','title': 'Direct Project','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 54,'number': '170.315 (g)(5)','title': 'Accessibility-Centered Design','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 53,'number': '170.315 (g)(4)','title': 'Quality Management System','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 56,'number': '170.315 (g)(7)','title': 'Application Access - Patient Selection','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 55,'number': '170.315 (g)(6)','title': 'Consolidated CDA Creation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 66,'number': '170.314 (a)(6)','title': 'Medication list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 65,'number': '170.314 (a)(5)','title': 'Problem list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 68,'number': '170.314 (a)(8)','title': 'Clinical decision support','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 67,'number': '170.314 (a)(7)','title': 'Medication allergy list','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 62,'number': '170.314 (a)(2)','title': 'Drug-drug, drug-allergy interactions checks','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 61,'number': '170.314 (a)(1)','title': 'Computerized provider order entry','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 64,'number': '170.314 (a)(4)','title': 'Vital signs, body mass index, and growth Charts','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 63,'number': '170.314 (a)(3)','title': 'Demographics','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 74,'number': '170.314 (a)(14)','title': 'Patient list creation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 73,'number': '170.314 (a)(13)','title': 'Family health history','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 76,'number': '170.314 (a)(16)','title': 'Inpatient setting only - electronic medication administration record','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 75,'number': '170.314 (a)(15)','title': 'Patient-specific education resources','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 70,'number': '170.314 (a)(10)','title': 'Drug formulary checks','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 69,'number': '170.314 (a)(9)','title': 'Electronic notes','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 72,'number': '170.314 (a)(12)','title': 'Image results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 71,'number': '170.314 (a)(11)','title': 'Smoking status','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 82,'number': '170.314 (b)(2)','title': 'Transitions of care - create and transmit transition of care/referral summaries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 81,'number': '170.314 (b)(1)','title': 'Transitions of care - receive, display and incorporate transition of care/referral summaries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 84,'number': '170.314 (b)(4)','title': 'Clinical information reconciliation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 83,'number': '170.314 (b)(3)','title': 'Electronic prescribing','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 78,'number': '170.314 (a)(18)','title': 'Optional - computerized provider order entry - medications','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 28,'number': '170.315 (c)(4)','title': 'Clinical Quality Measures - Filter','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 77,'number': '170.314 (a)(17)','title': 'Advance directives','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 80,'number': '170.314 (a)(20)','title': 'Optional - computerized provider order entry - diagnostic imaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 79,'number': '170.314 (a)(19)','title': 'Optional - computerized provider order entry - laboratory','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 90,'number': '170.314 (b)(9)','title': 'Optional - clinical information reconciliation and incorporation (CIRI)','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 89,'number': '170.314 (b)(8)','title': 'Optional - transitions of care','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 92,'number': '170.314 (c)(2)','title': 'Clinical quality measures - import and calculate','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 91,'number': '170.314 (c)(1)','title': 'Clinical quality measures - capture and export','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 86,'number': '170.314 (b)(5)(B)','title': 'Incorporate laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 85,'number': '170.314 (b)(5)(A)','title': 'Incorporate laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 88,'number': '170.314 (b)(7)','title': 'Data portability','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 87,'number': '170.314 (b)(6)','title': 'Inpatient setting only - transmission of electronic laboratory tests and values/results to ambulatory providers','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 98,'number': '170.314 (d)(5)','title': 'Automatic log-off','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 97,'number': '170.314 (d)(4)','title': 'Amendments','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 100,'number': '170.314 (d)(7)','title': 'End-user device encryption','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 99,'number': '170.314 (d)(6)','title': 'Emergency access','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 94,'number': '170.314 (d)(1)','title': 'Authentication, access, control, and authorization','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 93,'number': '170.314 (c)(3)','title': 'Clinical quality measures - electronic submission','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 96,'number': '170.314 (d)(3)','title': 'Audit report(s)','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 95,'number': '170.314 (d)(2)','title': 'Auditable events and tamper-resistance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 106,'number': '170.314 (f)(1)','title': 'Immunization information','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 105,'number': '170.314 (e)(3)','title': 'Ambulatory setting only - secure messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 108,'number': '170.314 (f)(3)','title': 'Transmission to public health agencies - syndromic surveillance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 107,'number': '170.314 (f)(2)','title': 'Transmission to immunization registries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 102,'number': '170.314 (d)(9)','title': 'Optional - accounting of disclosures','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 101,'number': '170.314 (d)(8)','title': 'Integrity','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 104,'number': '170.314 (e)(2)','title': 'Ambulatory setting only -clinical summary','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 103,'number': '170.314 (e)(1)','title': 'View, download, and transmit to a 3rd party with edge protocol testing','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 114,'number': '170.314 (g)(2)','title': 'Automated measure calculation','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 113,'number': '170.314 (g)(1)','title': 'Automated numerator recording','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 116,'number': '170.314 (g)(4)','title': 'Quality management system','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 115,'number': '170.314 (g)(3)','title': 'Safety-enhanced design','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 110,'number': '170.314 (f)(5)','title': 'Optional - ambulatory setting only - cancer case information','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 109,'number': '170.314 (f)(4)','title': 'Inpatient setting only - transmission of reportable laboratory tests and values/results','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 112,'number': '170.314 (f)(7)','title': 'Optional - ambulatory setting only - transmission to public health agencies - syndromic surveillance','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 111,'number': '170.314 (f)(6)','title': 'Optional - ambulatory setting only - transmission to cancer registries','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 3,'name': 'HIMSS-IIP Test Method','description': null,'title': null,'criteria': {'id': 43,'number': '170.315 (f)(1)','title': 'Transmission to Immunization Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 118,'number': '170.314 (h)(2)','title': 'Optional - Transmit - Applicability Statement for Secure Health Transport and XDR/XDM for Direct Messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 117,'number': '170.314 (h)(1)','title': 'Optional - Transmit - Applicability Statement for Secure Health','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 119,'number': '170.314 (h)(3)','title': 'Optional - Transmit - SOAP Transport and Security Specification and XDR/XDM for Direct Messaging','certificationEditionId': 2,'certificationEdition': '2014','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 2,'number': '170.315 (a)(2)','title': 'CPOE - Laboratory','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 1,'number': '170.315 (a)(1)','title': 'Computerized Provider Order Entry (CPOE) - Medications','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 4,'number': '170.315 (a)(4)','title': 'Drug-Drug, Drug-Allergy Interaction Checks for CPOE','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 3,'number': '170.315 (a)(3)','title': 'CPOE - Diagnostic Imaging','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 10,'number': '170.315 (a)(10)','title': 'Drug-Formulary and Preferred Drug List Checks','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 9,'number': '170.315 (a)(9)','title': 'Clinical Decision Support','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 12,'number': '170.315 (a)(12)','title': 'Family Health History','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 27,'number': '170.315 (c)(3)','title': 'Clinical Quality Measures - Report','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 11,'number': '170.315 (a)(11)','title': 'Smoking Status','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 2,'name': 'NCQA eCQM Test Method','description': null,'title': null,'criteria': {'id': 26,'number': '170.315 (c)(2)','title': 'Clinical Quality Measures - Import and Calculate','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 6,'number': '170.315 (a)(6)','title': 'Problem List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 5,'number': '170.315 (a)(5)','title': 'Demographics','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 8,'number': '170.315 (a)(8)','title': 'Medication Allergy List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 7,'number': '170.315 (a)(7)','title': 'Medication List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 18,'number': '170.315 (b)(3)','title': 'Electronic Prescribing','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 17,'number': '170.315 (b)(2)','title': 'Clinical Information Reconciliation and Incorporation','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 20,'number': '170.315 (b)(5)','title': 'Common Clinical Data Set Summary Record - Receive','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 19,'number': '170.315 (b)(4)','title': 'Common Clinical Data Set Summary Record - Create','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 14,'number': '170.315 (a)(14)','title': 'Implantable Device List','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 13,'number': '170.315 (a)(13)','title': 'Patient-Specific Education Resources','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 16,'number': '170.315 (b)(1)','title': 'Transitions of Care','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 15,'number': '170.315 (a)(15)','title': 'Social, Psychological, and Behavioral Determinants Data','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 26,'number': '170.315 (c)(2)','title': 'Clinical Quality Measures - Import and Calculate','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 25,'number': '170.315 (c)(1)','title': 'Clinical Quality Measures - Record and Export','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 28,'number': '170.315 (c)(4)','title': 'Clinical Quality Measures - Filter','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 27,'number': '170.315 (c)(3)','title': 'Clinical Quality Measures - Report','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 22,'number': '170.315 (b)(7)','title': 'Data Segmentation for Privacy - Send','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 21,'number': '170.315 (b)(6)','title': 'Data Export','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 24,'number': '170.315 (b)(9)','title': 'Care Plan','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 23,'number': '170.315 (b)(8)','title': 'Data Segmentation for Privacy - Receive','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 34,'number': '170.315 (d)(6)','title': 'Emergency Access','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 33,'number': '170.315 (d)(5)','title': 'Automatic Access Time-out','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 36,'number': '170.315 (d)(8)','title': 'Integrity','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 35,'number': '170.315 (d)(7)','title': 'End-User Device Encryption','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 30,'number': '170.315 (d)(2)','title': 'Auditable Events and Tamper-Resistance','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 29,'number': '170.315 (d)(1)','title': 'Authentication, Access Control, Authorization','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 32,'number': '170.315 (d)(4)','title': 'Amendments','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 31,'number': '170.315 (d)(3)','title': 'Audit Report(s)','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 42,'number': '170.315 (e)(3)','title': 'Patient Health Information Capture','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 41,'number': '170.315 (e)(2)','title': 'Secure Messaging','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 44,'number': '170.315 (f)(2)','title': 'Transmission to Public Health Agencies - Syndromic Surveillance','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 43,'number': '170.315 (f)(1)','title': 'Transmission to Immunization Registries','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 38,'number': '170.315 (d)(10)','title': 'Auditing Actions on Health Information','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 37,'number': '170.315 (d)(9)','title': 'Trusted Connection','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 40,'number': '170.315 (e)(1)','title': 'View, Download, and Transmit to 3rd Party','certificationEditionId': 3,'certificationEdition': '2015','description': null}},{'id': 1,'name': 'ONC Test Method','description': null,'title': null,'criteria': {'id': 39,'number': '170.315 (d)(11)','title': 'Accounting of Disclosures','certificationEditionId': 3,'certificationEdition': '2015','description': null}}]},
      testTools: {'expandable': false,'data': [{'id': 1,'name': 'ePrescribing Validation Tool','description': null,'retired': false},{'id': 15,'name': 'Transport Test Tool','description': null,'retired': true},{'id': 5,'name': 'HL7 v2 Laboratory Results Interface (LRI) Validation Tool','description': null,'retired': false},{'id': 11,'name': 'HL7v2 Syndromic Surveillance Test Suite','description': null,'retired': false},{'id': 9,'name': 'Direct Certificate Discovery Tool','description': null,'retired': false},{'id': 3,'name': 'HL7 v2 Electronic Laboratory Reporting (ELR) Validation Tool','description': null,'retired': false},{'id': 13,'name': 'Electronic Prescribing','description': null,'retired': false},{'id': 16,'name': 'Edge Test Tool','description': null,'retired': false},{'id': 7,'name': 'Transport Testing Tool','description': null,'retired': true},{'id': 17,'name': '2015 Direct Certificate Discovery Tool','description': null,'retired': false},{'id': 10,'name': 'HL7v2 Immunization Test Suite','description': null,'retired': false},{'id': 4,'name': 'HL7 v2 Immunization Information System (IIS) Reporting Validation Tool','description': null,'retired': false},{'id': 12,'name': 'HL7v2 Electronic Laboratory Reporting Validation Tool','description': null,'retired': false},{'id': 20,'name': 'HL7v2 Electronic Laboratory Reporting Validation Tool','description': null,'retired': false},{'id': 6,'name': 'HL7 v2 Syndromic Surveillance Reporting Validation Tool','description': null,'retired': false},{'id': 8,'name': 'Cypress','description': null,'retired': false},{'id': 14,'name': 'HL7 CDA National Health Care Surveys Validator','description': null,'retired': false},{'id': 2,'name': 'HL7 CDA Cancer Registry Reporting Validation Tool','description': null,'retired': false}]},
    };

    beforeEach(() => {
      angular.mock.module('chpl.components', 'chpl.shared', $provide => {
        $provide.factory('chplHighlightCuresDirective', () => ({}));
      });

      inject((_$compile_, _$log_, $rootScope) => {
        $compile = _$compile_;
        $log = _$log_;

        el = angular.element('<chpl-certification-criteria-edit close="close($value)" dismiss="dismiss()" resolve="resolve"></chpl-certification-criteria-edit>');

        scope = $rootScope.$new();
        scope.close = jasmine.createSpy('close');
        scope.dismiss = jasmine.createSpy('dismiss');
        scope.resolve = {
          cert: angular.copy(mock.cert),
          resources: mock.resources,
          hasIcs: false,
          isConfirming: false,
        };
        $compile(el)(scope);
        scope.$digest();
        ctrl = el.isolateScope().$ctrl;
      });
    });

    afterEach(() => {
      if ($log.debug.logs.length > 0) {
        /* eslint-disable no-console,angular/log */
        console.log('Debug:\n' + $log.debug.logs.map(o => angular.toJson(o)).join('\n'));
        /* eslint-enable no-console,angular/log */
      }
    });

    describe('template', () => {
      it('should be compiled', () => {
        expect(el.html()).not.toEqual(null);
      });
    });

    describe('controller', () => {
      it('should exist', () => {
        expect(ctrl).toBeDefined();
      });

      it('should have a way to close it\'s own modal', () => {
        expect(ctrl.cancel).toBeDefined();
        ctrl.cancel();
        expect(scope.dismiss).toHaveBeenCalled();
      });

      it('should farm out to utilService for extendSelect', () => {
        var options = [];
        ctrl.extendSelect(options, 'val');
        expect(options).toEqual([{name: 'val'}]);
      });

      describe('when concerned with retired tools', () => {
        it('should have a way of knowing if a tool is unselectable', () => {
          expect(ctrl.isToolDisabled).toBeDefined();
        });

        it('should know when a tool is available', () => {
          //When isConfirming = false (user is editing listing), all test tool are available
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[0])).toBe(false);
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[1])).toBe(false);

          ctrl.hasIcs = true;
          ctrl.isConfirming = true;
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[0])).toBe(false);
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[1])).toBe(false);

          ctrl.hasIcs = false;
          ctrl.isConfirming = true;
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[0])).toBe(false);
          expect(ctrl.isToolDisabled(mock.resources.testTools.data[1])).toBe(true);
        });
      });

      describe('when saving the certification', () => {
        it('should close the modal', () => {
          ctrl.save();
          expect(scope.close).toHaveBeenCalled();
        });
      });

      describe('when cancelling edits', () => {
        it('should restore the cert', () => {
          var editedCert = {id: 2, name: 'an edited cert'};
          ctrl.cert = editedCert;
          ctrl.cancel();
          expect(ctrl.cert).not.toEqual(editedCert);
        });
      });

      describe('related to additional software', () => {
        it('should know when it was not met via additional software', () => {
          expect(ctrl.cert.metViaAdditionalSoftware).toBeFalsy();
        });

        it('should know when it was met via additional software', () => {
          var certMet = {
            additionalSoftware: [1],
            criterion: {
              removed: false,
            },
          };
          scope.resolve = {
            cert: certMet,
            resources: mock.resources,
            hasIcs: false,
            isConfirming: false,
          };
          el = angular.element('<chpl-certification-criteria-edit close="close($value)" dismiss="dismiss()" resolve="resolve"></chpl-certification-criteria-edit>');
          $compile(el)(scope);
          scope.$digest();
          ctrl = el.isolateScope().$ctrl;

          expect(ctrl.cert.metViaAdditionalSoftware).toBe(true);
        });
      });

      describe('with regard to SVAP', () => {
        it('should add the display text to the SVAP object', () => {
          expect(ctrl.cert.allowedSvaps[0].displayText).toBe('reg1 ver1');
          expect(ctrl.cert.allowedSvaps[1].displayText).toBe('reg2 ver2');
        });

        it('should get a list of preselected SAVP ids', () => {
          expect(ctrl.selectedSvapKeys[0].key).toBe(1);
        });

        it('should add the SVAP to the cert', () => {
          ctrl.cert.svaps = [];
          let action = {
            action: 'Add',
            item: {
              item: {
                svapId: 1,
                regulatoryTextCitation: 'reg1',
                approvedStandardVersion: 'ver1',
              },
            },
          };
          ctrl.svapOnChange(action);
          expect(ctrl.cert.svaps.length).toBe(1);
        });

        it('should remove the SVAP from the cert', () => {
          expect(ctrl.cert.svaps.length).toBe(1);

          let action = {
            action: 'Remove',
            item: {
              item: {
                svapId: 1,
                regulatoryTextCitation: 'reg1',
                approvedStandardVersion: 'ver1',
              },
            },
          };
          ctrl.svapOnChange(action);
          expect(ctrl.cert.svaps.length).toBe(0);
        });
      });
    });
  });
})();
